{"version":3,"file":"index.js","sourceRoot":"","sources":["../src/index.tsx"],"names":[],"mappings":"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","sourcesContent":["/*!\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n\nimport {\n  PrimedComponent,\n  SimpleComponentInstantiationFactory,\n  SimpleModuleInstantiationFactory,\n} from \"@prague/aqueduct\";\nimport {\n  IComponentHTMLVisual,\n  IContainerContext,\n  IRuntime,\n} from \"@prague/container-definitions\";\nimport {\n  Counter,\n  CounterValueType,\n  SharedMap,\n} from \"@prague/map\";\nimport {\n  IComponentContext,\n  IComponentRuntime,\n} from \"@prague/runtime-definitions\";\n\nimport * as React from \"react\";\nimport * as ReactDOM from \"react-dom\";\n\n// tslint:disable-next-line: no-var-requires no-require-imports\nconst pkg = require(\"../package.json\");\nexport const ClickerName = pkg.name as string;\n\n/**\n * Basic Clicker example using new interfaces and stock component classes.\n */\nexport class Clicker extends PrimedComponent implements IComponentHTMLVisual {\n  private static readonly supportedInterfaces = [\"IComponentHTMLVisual\", \"IComponentHTMLRender\",\n  \"IComponentRouter\"];\n\n  /**\n   * Do setup work here\n   */\n  protected async create() {\n    // This allows the PrimedComponent to create the root map\n    await super.create();\n    this.root.set(\"clicks\", 0, CounterValueType.Name);\n  }\n\n  /**\n   * Static load function that allows us to make async calls while creating our object.\n   * This becomes the standard practice for creating components in the new world.\n   * Using a static allows us to have async calls in class creation that you can't have in a constructor\n   */\n  public static async load(runtime: IComponentRuntime, context: IComponentContext): Promise<Clicker> {\n    const clicker = new Clicker(runtime, context, Clicker.supportedInterfaces);\n    await clicker.initialize();\n\n    return clicker;\n  }\n\n  // start IComponentHTMLVisual\n\n  /**\n   * Will return a new Clicker view\n   */\n  public render(div: HTMLElement) {\n    // Get our counter object that we set in initialize and pass it in to the view.\n    const counter = this.root.get(\"clicks\");\n    ReactDOM.render(\n      <CounterReactView counter={counter} />,\n      div,\n    );\n    return div;\n  }\n\n  // end IComponentHTMLVisual\n}\n\n// ----- REACT STUFF -----\n\ninterface p {\n  counter: Counter;\n}\n\ninterface s {\n  value: number;\n}\n\nclass CounterReactView extends React.Component<p, s> {\n  constructor(props: p) {\n    super(props);\n\n    this.state = {\n      value: this.props.counter.value,\n    };\n  }\n\n  componentDidMount() {\n    this.props.counter.on(\"incremented\", (incrementValue: number, currentValue: number) => {\n      this.setState({ value: currentValue });\n    });\n  }\n\n  render() {\n    return (\n      <div>\n        <span>{this.state.value}</span><button onClick={() => { this.props.counter.increment(1); }}>+</button>\n      </div>\n    );\n  }\n}\n\n// ----- COMPONENT SETUP STUFF -----\nexport const ClickerInstantiationFactory = new SimpleComponentInstantiationFactory(\n  [\n    SharedMap.getFactory([new CounterValueType()]),\n  ],\n  Clicker.load,\n);\n\nexport const fluidExport = new SimpleModuleInstantiationFactory(\n  ClickerName,\n  new Map([\n    [ClickerName, Promise.resolve(ClickerInstantiationFactory)],\n  ]),\n);\n\n// Included for back compat - can remove in 0.7 once fluidExport is default\nexport async function instantiateRuntime(context: IContainerContext): Promise<IRuntime> {\n    return fluidExport.instantiateRuntime(context);\n}\n\n// Included for back compat - can remove in 0.7 once fluidExport is default\nexport async function instantiateComponent(context: IComponentContext): Promise<IComponentRuntime> {\n  return fluidExport.instantiateComponent(context);\n}\n"]}